"use strict";(self["webpackChunkforum_communautaire"]=self["webpackChunkforum_communautaire"]||[]).push([[364],{312(e,a,s){s.d(a,{A:()=>c});var t=s(144),i=s(51);const l=()=>{const e=(0,t.KR)(null),a=(0,t.KR)(!1),s=async s=>{e.value=null,a.value=!0;try{const e=await i.$_.collection("discussions").add({...s,createdAt:(0,i.vE)(),replies:0,views:0,reported:!1,reportCount:0});return a.value=!1,e}catch(t){console.error(t.message),e.value="Could not create discussion",a.value=!1}},l=async(s,t)=>{e.value=null,a.value=!0;try{await i.$_.collection("discussions").doc(s).update({...t,updatedAt:(0,i.vE)()}),a.value=!1}catch(l){console.error(l.message),e.value="Could not update discussion",a.value=!1}},c=async s=>{e.value=null,a.value=!0;try{await i.$_.collection("discussions").doc(s).delete();const e=await i.$_.collection("replies").where("discussionId","==",s).get(),t=i.$_.batch();e.docs.forEach(e=>{t.delete(e.ref)}),await t.commit(),a.value=!1}catch(t){console.error(t.message),e.value="Could not delete discussion",a.value=!1}},n=async e=>{try{await i.$_.collection("discussions").doc(e).update({views:i.$_.FieldValue.increment(1)})}catch(a){console.error("Could not increment views:",a.message)}};return{error:e,isPending:a,createDiscussion:s,updateDiscussion:l,deleteDiscussion:c,incrementViews:n}},c=l},364(e,a,s){s.r(a),s.d(a,{default:()=>$});var t=s(768),i=s(130),l=s(232);const c={class:"create-discussion"},n={class:"create-container"},o={class:"create-header"},r={class:"create-card"},u={class:"form-group"},d={class:"form-group"},v=["value"],b={class:"form-group"},p={class:"char-count"},k={key:0,class:"error-message"},m={key:1,class:"success-message"},h={class:"form-actions"},g=["disabled"],L=["disabled"],y={key:0},f={key:1};function C(e,a,s,C,w,x){const _=(0,t.g2)("Navbar"),D=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(_),(0,t.Lk)("div",n,[(0,t.Lk)("div",o,[(0,t.bF)(D,{to:"/home",class:"back-link"},{default:(0,t.k6)(()=>[...a[5]||(a[5]=[(0,t.Lk)("i",{class:"bi bi-arrow-left"},null,-1),(0,t.eW)(" Retour ",-1)])]),_:1}),a[6]||(a[6]=(0,t.Lk)("h1",null,"Créer une Nouvelle Discussion",-1)),a[7]||(a[7]=(0,t.Lk)("p",null,"Partagez vos idées avec la communauté",-1))]),(0,t.Lk)("div",r,[(0,t.Lk)("form",{onSubmit:a[4]||(a[4]=(0,i.D$)((...e)=>C.handleSubmit&&C.handleSubmit(...e),["prevent"]))},[(0,t.Lk)("div",u,[a[8]||(a[8]=(0,t.Lk)("label",{for:"title"},[(0,t.Lk)("i",{class:"bi bi-cursor-text"}),(0,t.eW)(" Titre de la discussion * ")],-1)),(0,t.bo)((0,t.Lk)("input",{id:"title","onUpdate:modelValue":a[0]||(a[0]=e=>C.title=e),type:"text",class:"modern-input",placeholder:"Donnez un titre accrocheur à votre discussion...",required:""},null,512),[[i.Jo,C.title]])]),(0,t.Lk)("div",d,[a[9]||(a[9]=(0,t.Lk)("label",{for:"category"},[(0,t.Lk)("i",{class:"bi bi-tag"}),(0,t.eW)(" Catégorie * ")],-1)),(0,t.bo)((0,t.Lk)("select",{id:"category","onUpdate:modelValue":a[1]||(a[1]=e=>C.category=e),class:"modern-select",required:""},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(C.categories,e=>((0,t.uX)(),(0,t.CE)("option",{key:e.value,value:e.value},(0,l.v_)(e.text),9,v))),128))],512),[[i.u1,C.category]])]),(0,t.Lk)("div",b,[a[10]||(a[10]=(0,t.Lk)("label",{for:"content"},[(0,t.Lk)("i",{class:"bi bi-card-text"}),(0,t.eW)(" Contenu de la discussion * ")],-1)),(0,t.bo)((0,t.Lk)("textarea",{id:"content","onUpdate:modelValue":a[2]||(a[2]=e=>C.content=e),class:"modern-textarea",placeholder:"Décrivez votre discussion en détail...",rows:"12",required:""},null,512),[[i.Jo,C.content]]),(0,t.Lk)("div",p,(0,l.v_)(C.content.length)+" caractères",1)]),C.error?((0,t.uX)(),(0,t.CE)("div",k,[a[11]||(a[11]=(0,t.Lk)("i",{class:"bi bi-exclamation-triangle-fill"},null,-1)),(0,t.Lk)("span",null,(0,l.v_)(C.error),1)])):(0,t.Q3)("",!0),C.success?((0,t.uX)(),(0,t.CE)("div",m,[...a[12]||(a[12]=[(0,t.Lk)("i",{class:"bi bi-check-circle-fill"},null,-1),(0,t.Lk)("span",null,"Discussion créée avec succès! Redirection...",-1)])])):(0,t.Q3)("",!0),(0,t.Lk)("div",h,[(0,t.Lk)("button",{type:"button",class:"btn-secondary",onClick:a[3]||(a[3]=a=>e.$router.push("/home")),disabled:C.isPending},[...a[13]||(a[13]=[(0,t.Lk)("i",{class:"bi bi-x-lg"},null,-1),(0,t.eW)(" Annuler ",-1)])],8,g),(0,t.Lk)("button",{type:"submit",class:"btn-primary",disabled:C.isPending||!C.title||!C.content},[C.isPending?((0,t.uX)(),(0,t.CE)("span",f,[...a[15]||(a[15]=[(0,t.Lk)("div",{class:"spinner"},null,-1),(0,t.eW)(" Publication en cours... ",-1)])])):((0,t.uX)(),(0,t.CE)("span",y,[...a[14]||(a[14]=[(0,t.Lk)("i",{class:"bi bi-send-fill"},null,-1),(0,t.eW)(" Publier la Discussion ",-1)])]))],8,L)])],32)]),a[16]||(a[16]=(0,t.Fv)('<div class="tips-card" data-v-7b21010a><h3 data-v-7b21010a><i class="bi bi-lightbulb" data-v-7b21010a></i> Conseils pour une bonne discussion</h3><ul data-v-7b21010a><li data-v-7b21010a><i class="bi bi-check2" data-v-7b21010a></i> Choisissez un titre clair et descriptif</li><li data-v-7b21010a><i class="bi bi-check2" data-v-7b21010a></i> Sélectionnez la catégorie appropriée</li><li data-v-7b21010a><i class="bi bi-check2" data-v-7b21010a></i> Développez votre sujet avec des détails</li><li data-v-7b21010a><i class="bi bi-check2" data-v-7b21010a></i> Restez respectueux et constructif</li></ul></div>',1))])])}var w=s(144),x=s(728),_=s(859),D=s(573),A=s(312);const E={name:"CreateDiscussion",components:{Navbar:_.A},setup(){const{user:e}=(0,D.A)(),{createDiscussion:a,error:s,isPending:t}=(0,A.A)(),i=(0,x.rd)(),l=(0,w.KR)(""),c=(0,w.KR)("general"),n=(0,w.KR)(""),o=(0,w.KR)(!1),r=[{value:"general",text:"Général"},{value:"tech",text:"Technologie"},{value:"support",text:"Support"},{value:"feedback",text:"Feedback"},{value:"announcements",text:"Annonces"},{value:"other",text:"Autres"}],u=async()=>{if(!e.value)return void(s.value="Vous devez être connecté pour créer une discussion");const t={title:l.value,content:n.value,category:c.value,authorId:e.value.uid,authorName:e.value.displayName||"Anonyme"},r=await a(t);!s.value&&r&&(o.value=!0,setTimeout(()=>{i.push({name:"Home"})},1500))};return{title:l,category:c,content:n,categories:r,error:s,isPending:t,success:o,handleSubmit:u}}};var P=s(241);const R=(0,P.A)(E,[["render",C],["__scopeId","data-v-7b21010a"]]),$=R}}]);
//# sourceMappingURL=364.80643efe.js.map